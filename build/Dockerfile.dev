FROM golang:1.25-alpine3.22

ARG APP_SERVICE=users
ENV SERVICE=${APP_SERVICE}

WORKDIR /app

RUN go install github.com/air-verse/air@latest

COPY go.* .

RUN go mod download

COPY . .

CMD air --build.cmd "go build -o ./bin/${SERVICE}-service ./cmd/services/${SERVICE}" --build.bin "./bin/${SERVICE}-service"
